<script>
    // JavaScript 實現倒數計時器
    const countdown = () => {
      // 設定婚禮日期（年份, 月份-1, 日期, 小時, 分鐘, 秒）
      const weddingDate = new Date("2025-12-20T12:00:00").getTime();
      const now = new Date().getTime();
      const difference = weddingDate - now;

      // 計算天、小時、分鐘、秒
      const days = Math.floor(difference / (1000 * 60 * 60 * 24));
      const hours = Math.floor((difference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((difference % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((difference % (1000 * 60)) / 1000);

      // 顯示在網頁上
      document.getElementById("countdown").innerHTML = 
        `<div><span class="text-4xl">${days}</span><br>天</div>` + 
        `<div><span class="text-4xl">${hours}</span><br>小時</div>` + 
        `<div><span class="text-4xl">${minutes}</span><br>分鐘</div>` + 
        `<div><span class="text-4xl">${seconds}</span><br>秒</div>`;

      // 如果時間到了，顯示訊息
      if (difference < 0) {
        clearInterval(x);
        document.getElementById("countdown").innerHTML = "我們結婚了！";
      }
    }

    // 每秒更新一次計時器
    setInterval(countdown, 1000);

    // 音樂播放控制
    const bgm = document.getElementById('bgm');
    const spinningDisk = document.getElementById('spinningDisk');
    const enterBtn = document.getElementById('enterBtn');
    const overlay = document.getElementById('overlay');
    
    // 點擊進入按鈕的事件監聽器
    enterBtn.addEventListener('click', () => {
      // 點擊後播放音樂並移除疊層
      const playPromise = bgm.play();

      // 處理 Promise 確保動畫執行
      if (playPromise !== undefined) {
        playPromise.then(_ => {
          // 成功播放，啟動動畫並隱藏疊層
          overlay.classList.add('fade-out');
          spinningDisk.classList.add('is-playing');
        }).catch(error => {
          // 播放被阻擋，依然隱藏疊層並啟動動畫
          console.log("音樂播放失敗，但仍繼續頁面轉換。");
          overlay.classList.add('fade-out');
          spinningDisk.classList.add('is-playing');
        });
      } else {
        // 舊版瀏覽器或沒有 Promise，直接執行
        overlay.classList.add('fade-out');
        spinningDisk.classList.add('is-playing');
      }
    });

    // 點擊照片的事件監聽器，用來播放/暫停音樂
    spinningDisk.addEventListener('click', () => {
        if (bgm.paused) {
            bgm.play();
            spinningDisk.classList.add('is-playing');
        } else {
            bgm.pause();
            spinningDisk.classList.remove('is-playing');
        }
    });

    // 頁面載入時先執行一次倒數計時
    window.onload = countdown;
</script>